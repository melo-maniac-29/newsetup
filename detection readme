This project provides a FastAPI backend that uses a trained PyTorch model (.pth) to detect hazards from uploaded images.
The model classifies images into:
ğŸŸ¡ Waterlogging
ğŸ”´ Electrical Hazard
âœ… No Hazard

ğŸ“‚ Project Structure
hazard-backend/
â”‚â”€â”€ app/
â”‚    â”œâ”€â”€ main.py              # FastAPI app entry point
â”‚    â”œâ”€â”€ utils.py             # Model loading + prediction functions
â”‚    â””â”€â”€ model/
â”‚         â””â”€â”€ hazard_classifier_mobilenetv2.pth
â”‚â”€â”€ requirements.txt
â”‚â”€â”€ README.md

âš™ï¸ Setup
1. Install dependencies
pip install fastapi uvicorn torch torchvision pillow

2. Model File (.pth)
The .pth file only contains the weights of the trained model.
To use it, we also need to:
Define the model architecture (e.g., mobilenet_v2 with 3 output classes).
Apply the same preprocessing transforms used during training (resize, normalize).
Map the class IDs â†’ human-readable labels.

Example:

from torchvision.models import mobilenet_v2
import torch.nn as nn

model = mobilenet_v2(pretrained=False)
model.classifier[1] = nn.Linear(model.last_channel, 3)  # 3 classes

ğŸš€ Run the Backend
1. Start FastAPI server
uvicorn app.main:app --reload

2. Endpoints

POST /predict/ â†’ Upload an image â†’ Returns predicted hazard class

(Future) /report/ â†’ Upload photo + location + description (for full workflow)

(Future) /status/{id} â†’ Check hazard handling status

ğŸ“Š Example Prediction
Input
curl -X POST "http://127.0.0.1:8000/predict/" \
  -F "file=@/path/to/test.jpg"

Output
{
  "id": 2,
  "label": "waterlogging hazard detected",
  "confidence": 0.92
}
